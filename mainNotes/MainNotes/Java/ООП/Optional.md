![[Pasted image 20240926115016.png]]
Либо хранит значение, которое точно не null, либо говорит, что значения нет.
Создание:
- Optional.of(obj) - создание Optional из объекта, который точно не null. Если объект будет null, то выбросится NullPointerException.
- Optional.ofNullabble(obj) - создание Optional, если obj != null, то он хранится в нем, если равен null, то просто Optional будет считаться пустым.
- Optiona.empty() - создать пустой Optional.

Зачем метод Optional.of() если есть Optional.ofNullable() ? Когда мы точно ожидаем, что переданное внутрь число не должно быть null. Если оно null, то, значит, какой-то случился баг и поэтому мы целенаправленно хотим, чтобы выбросилось исключение, а не скрыть эту ситуацию.

При работе с Optional часто используются цепочки вызовов
![[Pasted image 20240926120143.png]]
- filter - если в коробочке(Optional) что-то было, то мы тестируем это что-то с помощью предиката, переданного внутрь. А если не было, то предикат вообще не выполняется. Если предикат вернул false, то мы выкидываем это что-то из коробочки и она становится пустой. 
- map - используется для преобразования того, что было в коробочке. Т.е. для значения в коробочке применяется функция преобразования и результат сохраняется обратно в коробочку. А если коробочка была пуста, то ничего не выполняется.
- flatMap - во внутрь передается метод, который преобразует значение внутри коробочки в еще одну коробочку внутри которой лежит значение того же типа, что было изначально в коробочке. Т.е. x(тип U) -> Optional< U>. При этом потом эта внутренняя коробочка распаковывается и ее значение сохраняется во внешней коробоке, для которой вызывали flatMap. Т.е. если внутренняя коробка была empty, то и вняшняя станет empty.
- orElse - если коробочка пустая, то возвращается дефолтное значение. Т.е. orElse возвращает значение либо коробочки, либо переданное внутрь.
- orElseGet - если хотим не просто вернуть константу в случае пустой коробочки, а хотим, чтобы выполнился какой-то метод. Внутрь передаем Supplier, который как раз и вернет нам значение, если коробочка будет пустой. Плюсом является то, что если коробочка была не пустой, то Supplier не вызовется и мы сэкономим время.
- orElseThrow - если пустая коробочка, то выбрасывается исключение. Во внутрь передается Supplier, который должен вернуть объект исключения, который нужно выбросить. Т.к. для выбрасывания исключений нужно вызывать throw ExceptionObject. А не просто создать ExceptionObject.
- or - один Optional мы можем заменить на другой, в том случае если первый - пустой. Если Optional был не пустой, то or оставит изначальный Optional и не будет заменять его другим.
- ifPresentOrElse(x -> sout("print x"), () -> sout("nothing")) - можем передать два метода. Один выполнится, когда значение в Optional было, а другой, когда не было.

Пример использования
![[Pasted image 20240926121602.png]]

![[Pasted image 20240926121733.png]]
