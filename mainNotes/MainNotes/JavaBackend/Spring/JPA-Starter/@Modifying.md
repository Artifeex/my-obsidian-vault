Используется для @Query, если он меняет данные.
![[Pasted image 20241219173156.png]]
- clearAutomatically - решает нужно ли почистить persistentContext сессии или нет. Это важно, потому что изменения в Query выполняются ВНЕ persistentContext, а сразу в БД. Т.е. в persistentContext будет храниться старое значение, хотя мы уже изменили его в БД. И если в рамках этой же сессии мы будем получать сущность, которую ранее изменили в Query, то обновлений не увидим, т.к. возьмется сущность из persistentContext.
  clearAutomatically - решает эту проблему и очищает persistentContext перед обновлением сущности. Он не полностью очищает, а только удаляет из него сущности, которые будут обновлены в @Query
- flushAutomatically - эта настройка флашит сессию перед выполнением изменяющего Query. Важно в том случае, если мы не хотим потерять изменения, которые могли происходить с сущностями. Т.е. мы могли изменить что-то в сущности, потом вызвать метод @Query с изменением у которого clearAutomatically = true и тогда изменения, которые были перед @Query не будут отображены, т.к. сущности были удалены из persistentContext и flush сессии уже не отобразит изменения. По дефолту flush происходит автоматически перед выполнением query запроса, но, если кто-то извне изменил это поведение в конфигурациях, то мы можем обезопасить себя настройкой flushAutomatically, которая сделает то же самое, что и поведение по умолчанию.