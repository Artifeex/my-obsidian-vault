По дефолту используется DaoAuthenticationProvider. Но есть сценарии, когда нам нужно писать свои собственные Authentication провайдеры. Например, мы хотим использовать OAUTH2 или JWT токен вариант аутентификации. Для них нужно будет писать собственные Authentication провайдеры, поскольку это не стандартный подход, где забираются данные из БД и сравниваются пароли. 
![[Pasted image 20241224133547.png]]
Filters формирует объект Authentication. А ProviderManger его получает и по типу этого Authentication объекта понимает, какой Authentication Provider использовать. 

Еще сценарии: хотим, чтобы аутентификация происходила только для тех пользователей, возраст которых больше 18 лет. Или только из определенных стран. Это все кастомное поведение, которое нужно будет писать в своей реализации Authentication провайдера.

Внутри своего кастомного Authentication провайдера мы можем выполнить кастомные проверки и на основе их результата создать Authentication объект, в котором будет храниться результата аутентификации. 

### Interface AuthenticationProvider
![[Pasted image 20241224134536.png]]
С помощью supports определяется как раз, поддерживается ли данным AuthenticationProvider-ом данный тип аутентификации. Т.е. фильтры же создают объект, реализующий интерфейс Authentication. И этот объект может быть различными классами. И тут мы можем проверить. Вот, например, в DaoAuthenticationProvider проверяется, что фильтры создали именно UsernamePasswordAuthenticationToken(класс, который реализует Authentication интерфейс) 
![[Pasted image 20241224134929.png]]

Когда мы создаем свой AuthenticationProvider, то Spring не создает стандартный DaoAuthenticationProvider.
Вот так можем написать свой AuthenticationProvider и в нем мы могли использовать любую логику. Данный AuthenticationProvider будет использоваться AuthenticationManager, который будет проходить по списку AuthenticationProvider(доступных в приложении) и сначала проверять, поддерживают ли данные провайдеры тот тип аутентификации, который пытается выполнить пользователь.
![[Pasted image 20241224141224.png]]

Вот вся схема, которая происходит при аутентификации
![[Pasted image 20241224141507.png]]
